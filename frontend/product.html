<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Roboto', sans-serif; margin: 0; padding: 0; background: #f8f9fa; }

    /* Navbar */
    nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.8rem 2rem;
      background: #131921;
      color: white;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    nav .logo { font-size: 1.8rem; font-weight: 700; color: #ff9900; }
    nav ul { display: flex; list-style: none; gap: 1.2rem; margin: 0; padding: 0; }
    nav ul li a { color: white; text-decoration: none; font-weight: 500; font-size: 0.95rem; transition: color 0.3s; }
    nav ul li a:hover { color: #febd69; }

    /* Product wrapper */
    .product-wrapper { max-width: 1200px; margin: 2rem auto; display: flex; gap: 2rem; background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 6px 12px rgba(0,0,0,0.1); flex-wrap: wrap; }
    .product-wrapper img { max-width: 500px; width: 100%; border-radius: 8px; object-fit: contain; }
    .product-info { flex: 1; min-width: 280px; }
    .product-info h1 { font-size: 1.8rem; color: #1a1f36; margin-bottom: 0.5rem; }
    .product-info p.price { font-size: 1.6rem; color: #ff6b35; font-weight: bold; margin: 1rem 0; }
    .product-info p.description { font-size: 1rem; line-height: 1.6; color: #333; }
    .actions { margin-top: 1.5rem; }
    .actions button {
      padding: 0.8rem 2rem;
      border: none;
      background: #1f7aec;
      color: white;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .actions button:hover { background: #1551b0; }

    /* Footer */
    footer {
      background: #131921;
      color: white;
      padding: 2.5rem 2rem;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 2rem;
      border-top: 4px solid #febd69;
    }
    footer .footer-section { flex: 1 1 250px; }
    footer h3 { font-size: 1.2rem; margin-bottom: 1rem; color: #febd69; }
    footer ul { list-style: none; padding: 0; }
    footer ul li { margin-bottom: 0.5rem; }
    footer ul li a { color: white; text-decoration: none; font-size: 0.9rem; transition: color 0.3s; }
    footer ul li a:hover { color: #febd69; }
    footer p { font-size: 0.9rem; line-height: 1.5; }
    footer .footer-bottom {
      width: 100%;
      text-align: center;
      margin-top: 2rem;
      font-size: 0.85rem;
      border-top: 1px solid #444;
      padding-top: 1rem;
      color: #aaa;
    }
  </style>
</head>
<body>

  <nav>
    <div class="logo">ShopEasy</div>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="login.html">Login</a></li>
      <li><a href="register.html">Register</a></li>
      <li><a href="cart.html">Cart</a></li>
      <li><a href="orders.html">My Orders</a></li>
    </ul>
  </nav>

  <div class="product-wrapper" id="productContainer">
    <!-- Product details will load here dynamically -->
  </div>

  <footer>
    <div class="footer-section">
      <h3>About ShopEasy</h3>
      <p>ShopEasy is your one-stop shop for fashion, electronics, and more.</p>
    </div>
    <div class="footer-section">
      <h3>Quick Links</h3>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="cart.html">Cart</a></li>
        <li><a href="login.html">Login</a></li>
        <li><a href="register.html">Register</a></li>
      </ul>
    </div>
    <div class="footer-section">
      <h3>Customer Service</h3>
      <ul>
        <li><a href="#">Help Center</a></li>
        <li><a href="#">Returns</a></li>
        <li><a href="#">Shipping Info</a></li>
        <li><a href="#">Contact Us</a></li>
      </ul>
    </div>
    <div class="footer-bottom">
      &copy; 2025 ShopEasy. All rights reserved.
    </div>
  </footer>

  <script>
document.addEventListener("DOMContentLoaded", async () => {
  const productContainer = document.getElementById("productContainer");

  // Get product ID from URL
  const urlParams = new URLSearchParams(window.location.search);
  const productId = urlParams.get("id");

  if (!productId) {
    productContainer.innerHTML = "<p>Product ID missing!</p>";
    return;
  }

  try {
    // Fetch product from backend
    const res = await fetch(`http://localhost:5000/api/products/${productId}`);
    if (!res.ok) throw new Error("Product not found");

    const data = await res.json();

    // Adjust if backend returns { product: {...} }
    const product = data.product || data;

    if (!product._id) {
      productContainer.innerHTML = "<p>Product data invalid!</p>";
      return;
    }

    productContainer.innerHTML = `
      <img src="${product.images?.[0] || 'placeholder.jpg'}" alt="${product.title}">
      <div class="product-info">
        <h1>${product.title}</h1>
        <p class="price">$${product.price.toFixed(2)}</p>
        <p class="description">${product.description}</p>
        <div class="actions">
          <button onclick="addToCart('${product._id}')">Add to Cart</button>
        </div>
      </div>
    `;
  } catch (err) {
    console.error(err);
    productContainer.innerHTML = `<p>Product not found!</p>`;
  }
});

// Add to Cart function
async function addToCart(productId) {
  const token = localStorage.getItem("token");
  if (!token) {
    alert("Please login to add items to cart.");
    window.location.href = "login.html";
    return;
  }

  try {
    const res = await fetch("http://localhost:5000/api/cart/add", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer " + token
      },
      body: JSON.stringify({ productId, quantity: 1 })
    });

    const data = await res.json();
    if (res.ok) {
      alert(data.message || "Added to cart!");
    } else {
      alert(data.message || "Failed to add item to cart.");
    }
  } catch (err) {
    console.error(err);
    alert("Something went wrong adding item to cart.");
  }
}
  </script>

</body>
</html>
